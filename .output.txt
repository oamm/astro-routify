
> astro-routify@1.5.0 test
> vitest run
 RUN  v3.2.4 D:/Git/astro-routify
 ❯ tests/Autoregistration.test.ts [queued]
 ❯ tests/CatchAllCapture.test.ts [queued]
 ❯ tests/Context.test.ts [queued]
stdout | tests/CatchAllCapture.test.ts > Catch-all Capture > should capture remaining segments in ctx.params["*"]
[RouterBuilder] Registered routes:
  GET     /static/**
[astro-routify] → GET /static/path/to/file.txt
stdout | tests/ParamCollision.test.ts > Param Collision > should correctly bind param names when routes share dynamic segments
[RouterBuilder] Registered routes:
  GET     /users/:id
  GET     /users/:slug/profile
[astro-routify] → GET /users/123
stdout | tests/Middleware.test.ts > Middleware System > should execute global middlewares in order
[RouterBuilder] Registered routes:
  GET     /test
[astro-routify] → GET /api/test
stdout | tests/RegexConstraints.test.ts > Regex Constraints > should match regex-constrained parameters
[RouterBuilder] Registered routes:
  GET     /users/:id(\d+)
[astro-routify] → GET /api/users/123
stdout | tests/Autoregistration.test.ts > Autoregistration > should auto-register a route
[RouterBuilder] Registered routes:
  GET     /auto-route
[astro-routify] → GET /auto-route
stdout | tests/WildcardMatching.test.ts > Wildcard Matching > should match single segment wildcard (*)
[RouterBuilder] Registered routes:
  GET     /files/*/download
[astro-routify] → GET /api/files/photo/download
stdout | tests/ErrorHandling.test.ts > Error Handling > should use custom onError handler when provided
[RouterBuilder] Registered routes:
  GET     /error
[astro-routify] → GET /api/error
stdout | tests/Context.test.ts > RoutifyContext > should provide parsed query parameters in ctx.query
[RouterBuilder] Registered routes:
  GET     /search
[astro-routify] → GET /api/search
stdout | tests/PriorityMatching.test.ts > Priority Matching > should prioritize more specific routes over wildcards
[RouterBuilder] Registered routes:
  GET     /files/config/download
  GET     /files/*/download
[astro-routify] → GET /api/files/config/download
stdout | tests/CatchAllCapture.test.ts > Catch-all Capture > should capture remaining segments in ctx.params["*"]
[astro-routify] ← responded 200 in 1ms
stdout | tests/RegexConstraints.test.ts > Regex Constraints > should match regex-constrained parameters
[astro-routify] ← responded 200 in 1ms
stdout | tests/OpenAPI.test.ts > OpenAPI Generation > should generate valid OpenAPI 3.0 spec with correct path formatting
[RouterBuilder] Registered routes:
  GET     /users/:id
  POST    /login
  GET     /posts/:postId/comments/:commentId
stdout | tests/Middleware.test.ts > Middleware System > should execute global middlewares in order
[astro-routify] ← responded 200 in 1ms
 ✓ tests/defineGroup.test.ts (6 tests) 3ms
stdout | tests/RouterBuilder.test.ts > RouterBuilder > should build and route with addGet
[RouterBuilder] Registered routes:
  GET     /ping
[astro-routify] → GET /api/ping
stdout | tests/WildcardMatching.test.ts > Wildcard Matching > should match single segment wildcard (*)
[astro-routify] ← responded 200 in 1ms
stdout | tests/HMR.test.ts > HMR Simulation > should overwrite old handler with new one in global registry (Auto-registration HMR)
[RouterBuilder] Registered routes:
  GET     /test
[astro-routify] → GET /api/test
stdout | tests/ParamCollision.test.ts > Param Collision > should correctly bind param names when routes share dynamic segments
[astro-routify] ← responded 200 in 2ms
stdout | tests/Autoregistration.test.ts > Autoregistration > should auto-register a route
[astro-routify] ← responded 200 in 2ms
stdout | tests/ErrorHandling.test.ts > Error Handling > should use custom onError handler when provided
[astro-routify] ← responded 500 in 2ms
stdout | tests/OpenAPI.test.ts > OpenAPI Generation > should handle regex parameters in OpenAPI paths
[RouterBuilder] Registered routes:
  GET     /users/:id(\d+)
stdout | tests/Context.test.ts > RoutifyContext > should provide parsed query parameters in ctx.query
[astro-routify] ← responded 200 in 2ms
stdout | tests/PriorityMatching.test.ts > Priority Matching > should prioritize more specific routes over wildcards
[astro-routify] ← responded 200 in 2ms
stdout | tests/Validation.test.ts > Validation Middleware > should accept valid request body
[RouterBuilder] Registered routes:
  POST    /user
[astro-routify] → POST /api/user
stdout | tests/RegexConstraints.test.ts > Regex Constraints > should match regex-constrained parameters
[astro-routify] → GET /api/users/abc
stdout | tests/CatchAllCapture.test.ts > Catch-all Capture > should capture empty remaining segments
[RouterBuilder] Registered routes:
  GET     /static/**
[astro-routify] → GET /static
stdout | tests/RegexConstraints.test.ts > Regex Constraints > should match regex-constrained parameters
[astro-routify] ← responded 404 in 0ms
stdout | tests/CatchAllCapture.test.ts > Catch-all Capture > should capture empty remaining segments
[astro-routify] ← responded 200 in 0ms
 ✓ tests/route-trie.test.ts (7 tests) 4ms
stdout | tests/Middleware.test.ts > Middleware System > should support group-level middlewares
[RouterBuilder] Registered routes:
  GET     /public
[astro-routify] → GET /api/admin/dashboard
stdout | tests/RouterBuilder.test.ts > RouterBuilder > should build and route with addGet
[astro-routify] ← responded 200 in 2ms
stdout | tests/stream.integration.test.ts > stream() helper - integration > streams chunks and closes (SSE by default)
[astro-routify] → GET /api/sse
stdout | tests/WildcardMatching.test.ts > Wildcard Matching > should match single segment wildcard (*)
[astro-routify] → GET /api/files/video/download
 ✓ tests/OpenAPI.test.ts (2 tests) 5ms
stdout | tests/streamJson.integration.test.ts > streamJson split helpers - integration > streams NDJSON values
[astro-routify] → GET /api/ndjson
stdout | tests/HMR.test.ts > HMR Simulation > should overwrite old handler with new one in global registry (Auto-registration HMR)
[astro-routify] ← responded 200 in 2ms
stdout | tests/RegexConstraints.test.ts > Regex Constraints > should handle complex regex
[RouterBuilder] Registered routes:
  GET     /color/:hex(^([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$)
[astro-routify] → GET /api/color/ff0000
stdout | tests/RequestIndependence.test.ts > Request Independence > should maintain independent params for concurrent requests
[RouterBuilder] Registered routes:
  GET     /users/:id
[astro-routify] → GET /api/users/user-0
[astro-routify] → GET /api/users/user-1
[astro-routify] → GET /api/users/user-2
[astro-routify] → GET /api/users/user-3
[astro-routify] → GET /api/users/user-4
[astro-routify] → GET /api/users/user-5
[astro-routify] → GET /api/users/user-6
[astro-routify] → GET /api/users/user-7
[astro-routify] → GET /api/users/user-8
[astro-routify] → GET /api/users/user-9
[astro-routify] → GET /api/users/user-10
[astro-routify] → GET /api/users/user-11
[astro-routify] → GET /api/users/user-12
[astro-routify] → GET /api/users/user-13
[astro-routify] → GET /api/users/user-14
[astro-routify] → GET /api/users/user-15
[astro-routify] → GET /api/users/user-16
[astro-routify] → GET /api/users/user-17
[astro-routify] → GET /api/users/user-18
[astro-routify] → GET /api/users/user-19
[astro-routify] → GET /api/users/user-20
[astro-routify] → GET /api/users/user-21
[astro-routify] → GET /api/users/user-22
[astro-routify] → GET /api/users/user-23
[astro-routify] → GET /api/users/user-24
[astro-routify] → GET /api/users/user-25
[astro-routify] → GET /api/users/user-26
[astro-routify] → GET /api/users/user-27
[astro-routify] → GET /api/users/user-28
[astro-routify] → GET /api/users/user-29
[astro-routify] → GET /api/users/user-30
[astro-routify] → GET /api/users/user-31
[astro-routify] → GET /api/users/user-32
[astro-routify] → GET /api/users/user-33
[astro-routify] → GET /api/users/user-34
[astro-routify] → GET /api/users/user-35
[astro-routify] → GET /api/users/user-36
[astro-routify] → GET /api/users/user-37
[astro-routify] → GET /api/users/user-38
[astro-routify] → GET /api/users/user-39
[astro-routify] → GET /api/users/user-40
[astro-routify] → GET /api/users/user-41
[astro-routify] → GET /api/users/user-42
[astro-routify] → GET /api/users/user-43
[astro-routify] → GET /api/users/user-44
[astro-routify] → GET /api/users/user-45
[astro-routify] → GET /api/users/user-46
[astro-routify] → GET /api/users/user-47
[astro-routify] → GET /api/users/user-48
[astro-routify] → GET /api/users/user-49
stdout | tests/Middleware.test.ts > Middleware System > should support group-level middlewares
[astro-routify] ← responded 200 in 0ms
stdout | tests/ParamCollision.test.ts > Param Collision > should correctly bind param names when routes share dynamic segments
[astro-routify] → GET /users/alex/profile
stdout | tests/stream.integration.test.ts > stream() helper - integration > streams chunks and closes (SSE by default)
[astro-routify] ← responded 200 in 3ms
stdout | tests/WildcardMatching.test.ts > Wildcard Matching > should match single segment wildcard (*)
[astro-routify] ← responded 200 in 0ms
stdout | tests/streamJson.integration.test.ts > streamJson split helpers - integration > streams NDJSON values
[astro-routify] ← responded 200 in 3ms
stdout | tests/RegexConstraints.test.ts > Regex Constraints > should handle complex regex
[astro-routify] ← responded 200 in 0ms
stdout | tests/Validation.test.ts > Validation Middleware > should accept valid request body
[astro-routify] ← responded 200 in 3ms
stdout | tests/PriorityMatching.test.ts > Priority Matching > should prioritize more specific routes over wildcards
[astro-routify] → GET /api/files/other/download
stdout | tests/Autoregistration.test.ts > Autoregistration > should auto-register a group
[RouterBuilder] Registered routes:
[astro-routify] → GET /auto-group/test
stdout | tests/ErrorHandling.test.ts > Error Handling > should fallback to default error handling if no onError is provided
[RouterBuilder] Registered routes:
  GET     /error
[astro-routify] → GET /api/error
stdout | tests/Middleware.test.ts > Middleware System > should support group-level middlewares
[astro-routify] → GET /api/public
stdout | tests/ParamCollision.test.ts > Param Collision > should correctly bind param names when routes share dynamic segments
[astro-routify] ← responded 200 in 0ms
stdout | tests/WildcardMatching.test.ts > Wildcard Matching > should match single segment wildcard (*)
[astro-routify] → GET /api/files/too/many/download
stdout | tests/RegexConstraints.test.ts > Regex Constraints > should handle complex regex
[astro-routify] → GET /api/color/fff
stdout | tests/PriorityMatching.test.ts > Priority Matching > should prioritize more specific routes over wildcards
[astro-routify] ← responded 200 in 0ms
stdout | tests/Middleware.test.ts > Middleware System > should support group-level middlewares
[astro-routify] ← responded 200 in 0ms
stdout | tests/WildcardMatching.test.ts > Wildcard Matching > should match single segment wildcard (*)
[astro-routify] ← responded 404 in 0ms
 ✓ tests/CatchAllCapture.test.ts (2 tests) 5ms
stdout | tests/RegexConstraints.test.ts > Regex Constraints > should handle complex regex
[astro-routify] ← responded 200 in 0ms
stdout | tests/Autoregistration.test.ts > Autoregistration > should auto-register a group
[astro-routify] ← responded 200 in 0ms
stdout | tests/Context.test.ts > RoutifyContext > should provide an empty state object in ctx.state
[RouterBuilder] Registered routes:
  GET     /state
[astro-routify] → GET /api/state
stdout | tests/Middleware.test.ts > Middleware System > should allow middleware to short-circuit the request
[RouterBuilder] Registered routes:
  GET     /test
[astro-routify] → GET /api/test
stdout | tests/RegexConstraints.test.ts > Regex Constraints > should handle complex regex
[astro-routify] → GET /api/color/red
stdout | tests/Context.test.ts > RoutifyContext > should provide an empty state object in ctx.state
[astro-routify] ← responded 200 in 0ms
stdout | tests/Middleware.test.ts > Middleware System > should allow middleware to short-circuit the request
[astro-routify] ← responded 200 in 0ms
stdout | tests/RegexConstraints.test.ts > Regex Constraints > should handle complex regex
[astro-routify] ← responded 404 in 0ms
stdout | tests/HMR.test.ts > HMR Simulation > should overwrite old handler with new one in global registry (Auto-registration HMR)
[RouterBuilder] Registered routes:
  GET     /test
[astro-routify] → GET /api/test
stdout | tests/WildcardMatching.test.ts > Wildcard Matching > should match catch-all wildcard (**)
[RouterBuilder] Registered routes:
  GET     /static/**
[astro-routify] → GET /api/static/css/main.css
stdout | tests/RegexConstraints.test.ts > Regex Constraints > should handle multiple regex params in one path
[RouterBuilder] Registered routes:
  GET     /v1/:year(\d{4})/:month(\d{2})
[astro-routify] → GET /api/v1/2024/05
stdout | tests/RegexConstraints.test.ts > Regex Constraints > should handle multiple regex params in one path
[astro-routify] ← responded 200 in 0ms
 ✓ tests/ParamCollision.test.ts (1 test) 7ms
 ✓ tests/stream.integration.test.ts (1 test) 6ms
stdout | tests/Autoregistration.test.ts > Autoregistration > createRouter should automatically include registered items
[RouterBuilder] Registered routes:
  GET     /create-router-auto
[astro-routify] → GET /create-router-auto
stdout | tests/WildcardMatching.test.ts > Wildcard Matching > should match catch-all wildcard (**)
[astro-routify] ← responded 200 in 0ms
stdout | tests/RegexConstraints.test.ts > Regex Constraints > should handle multiple regex params in one path
[astro-routify] → GET /api/v1/2024/may
stdout | tests/HMR.test.ts > HMR Simulation > should overwrite old handler with new one in global registry (Auto-registration HMR)
[astro-routify] ← responded 200 in 0ms
stdout | tests/RouterBuilder.test.ts > RouterBuilder > should build and route with addPost
[RouterBuilder] Registered routes:
  POST    /submit
[astro-routify] → POST /api/submit
stdout | tests/streamJson.integration.test.ts > streamJson split helpers - integration > streams a valid JSON array
[astro-routify] → GET /api/array
stdout | tests/RequestIndependence.test.ts > Request Independence > should maintain independent params for concurrent requests
[astro-routify] ← responded 200 in 4ms
stdout | tests/Autoregistration.test.ts > Autoregistration > createRouter should automatically include registered items
[astro-routify] ← responded 200 in 0ms
stdout | tests/RegexConstraints.test.ts > Regex Constraints > should handle multiple regex params in one path
[astro-routify] ← responded 404 in 0ms
stdout | tests/PriorityMatching.test.ts > Priority Matching > should follow priority: Static > Regex > Param > Wildcard > Catch-all
[RouterBuilder] Registered routes:
  GET     /p/static
  GET     /p/:id(\d+)
  GET     /p/:id
  GET     /p/*
  GET     /**
[astro-routify] → GET /api/p/static
stdout | tests/streamJson.integration.test.ts > streamJson split helpers - integration > streams a valid JSON array
[astro-routify] ← responded 200 in 0ms
stdout | tests/RouterBuilder.test.ts > RouterBuilder > should build and route with addPost
[astro-routify] ← responded 200 in 0ms
stdout | tests/PriorityMatching.test.ts > Priority Matching > should follow priority: Static > Regex > Param > Wildcard > Catch-all
[astro-routify] ← responded 200 in 0ms
stdout | tests/WildcardMatching.test.ts > Wildcard Matching > should match catch-all wildcard (**)
[astro-routify] → GET /api/static/js/vendor/jquery.js
stdout | tests/WildcardMatching.test.ts > Wildcard Matching > should match catch-all wildcard (**)
[astro-routify] ← responded 200 in 0ms
 ✓ tests/Middleware.test.ts (3 tests) 7ms
stdout | tests/Validation.test.ts > Validation Middleware > should reject invalid request body with 400
[RouterBuilder] Registered routes:
  POST    /user
[astro-routify] → POST /api/user
stdout | tests/PriorityMatching.test.ts > Priority Matching > should follow priority: Static > Regex > Param > Wildcard > Catch-all
[astro-routify] → GET /api/p/123
 ✓ tests/Context.test.ts (2 tests) 7ms
stdout | tests/WildcardMatching.test.ts > Wildcard Matching > should match catch-all wildcard (**)
[astro-routify] → GET /api/static
 ✓ tests/RegexConstraints.test.ts (3 tests) 7ms
stdout | tests/streamJson.integration.test.ts > streamJson split helpers - integration > handles AbortSignal during NDJSON stream
[astro-routify] → GET /api/abort
stdout | tests/HMR.test.ts > HMR Simulation > should support HMR via addModules (import.meta.glob simulation)
[RouterBuilder] Registered routes:
  GET     /module
[astro-routify] → GET /api/module
stdout | tests/RouterBuilder.test.ts > RouterBuilder > should support route groups via addGroup
[RouterBuilder] Registered routes:
[astro-routify] → GET /api/group/test
stdout | tests/Validation.test.ts > Validation Middleware > should reject invalid request body with 400
[astro-routify] ← responded 400 in 1ms
 ✓ tests/Autoregistration.test.ts (3 tests) 7ms
stdout | tests/RequestIndependence.test.ts > Request Independence > should maintain independent params for concurrent requests
[astro-routify] ← responded 200 in 3ms
stdout | tests/PriorityMatching.test.ts > Priority Matching > should follow priority: Static > Regex > Param > Wildcard > Catch-all
[astro-routify] ← responded 200 in 0ms
stdout | tests/WildcardMatching.test.ts > Wildcard Matching > should match catch-all wildcard (**)
[astro-routify] ← responded 200 in 0ms
stdout | tests/streamJson.integration.test.ts > streamJson split helpers - integration > handles AbortSignal during NDJSON stream
[astro-routify] ← responded 200 in 0ms
stdout | tests/HMR.test.ts > HMR Simulation > should support HMR via addModules (import.meta.glob simulation)
[astro-routify] ← responded 200 in 0ms
 ✓ tests/responseHelpers.test.ts (14 tests) 7ms
stdout | tests/RouterBuilder.test.ts > RouterBuilder > should support route groups via addGroup
[astro-routify] ← responded 200 in 0ms
stdout | tests/Validation.test.ts > Validation Middleware > should validate query parameters
[RouterBuilder] Registered routes:
  GET     /search
[astro-routify] → GET /api/search
stderr | tests/ErrorHandling.test.ts > Error Handling > should fallback to default error handling if no onError is provided
[astro-routify] handler error Error: Default Error
    at Object.handler (D:\Git\astro-routify\tests\ErrorHandling.test.ts:35:19)
    at next (D:\Git\astro-routify\src\core\defineRouter.ts:148:48)
    at D:\Git\astro-routify\src\core\defineRouter.ts:153:26
    at D:\Git\astro-routify\src\core\defineHandler.ts:75:34
    at D:\Git\astro-routify\tests\ErrorHandling.test.ts:40:27
    at file:///D:/Git/astro-routify/node_modules/.pnpm/@vitest+runner@3.2.4/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11
    at file:///D:/Git/astro-routify/node_modules/.pnpm/@vitest+runner@3.2.4/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26
    at file:///D:/Git/astro-routify/node_modules/.pnpm/@vitest+runner@3.2.4/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20
    at new Promise (<anonymous>)
    at runWithTimeout (file:///D:/Git/astro-routify/node_modules/.pnpm/@vitest+runner@3.2.4/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)
stdout | tests/RequestIndependence.test.ts > Request Independence > should maintain independent params for concurrent requests
[astro-routify] ← responded 200 in 3ms
stdout | tests/PriorityMatching.test.ts > Priority Matching > should follow priority: Static > Regex > Param > Wildcard > Catch-all
[astro-routify] → GET /api/p/abc
stdout | tests/WildcardMatching.test.ts > Wildcard Matching > should handle wildcards in the middle of a path
[RouterBuilder] Registered routes:
  GET     /a/*/c
[astro-routify] → GET /api/a/b/c
stdout | tests/HMR.test.ts > HMR Simulation > should support HMR via addModules (import.meta.glob simulation)
[RouterBuilder] Registered routes:
  GET     /module
[astro-routify] → GET /api/module
stdout | tests/RouterBuilder.test.ts > RouterBuilder > should build and route with addRoute manually
[RouterBuilder] Registered routes:
  GET     /manual
[astro-routify] → GET /api/manual
stdout | tests/Validation.test.ts > Validation Middleware > should validate query parameters
[astro-routify] ← responded 200 in 0ms
stdout | tests/ErrorHandling.test.ts > Error Handling > should fallback to default error handling if no onError is provided
[astro-routify] ← responded 500 in 3ms
stdout | tests/defineGroup.integration.test.ts > RouterBuilder + defineGroup - route handling > should match a group route and return correct response
[RouterBuilder] Registered routes:
[astro-routify] → GET /api/users/123
stdout | tests/RequestIndependence.test.ts > Request Independence > should maintain independent params for concurrent requests
[astro-routify] ← responded 200 in 4ms
stdout | tests/PriorityMatching.test.ts > Priority Matching > should follow priority: Static > Regex > Param > Wildcard > Catch-all
[astro-routify] ← responded 200 in 0ms
stdout | tests/WildcardMatching.test.ts > Wildcard Matching > should handle wildcards in the middle of a path
[astro-routify] ← responded 200 in 0ms
stdout | tests/HMR.test.ts > HMR Simulation > should support HMR via addModules (import.meta.glob simulation)
[astro-routify] ← responded 200 in 0ms
stdout | tests/RouterBuilder.test.ts > RouterBuilder > should build and route with addRoute manually
[astro-routify] ← responded 200 in 0ms
stdout | tests/Validation.test.ts > Validation Middleware > should validate query parameters
[astro-routify] → GET /api/search
stdout | tests/RequestIndependence.test.ts > Request Independence > should maintain independent params for concurrent requests
[astro-routify] ← responded 200 in 5ms
stdout | tests/PriorityMatching.test.ts > Priority Matching > should follow priority: Static > Regex > Param > Wildcard > Catch-all
[astro-routify] → GET /api/something/else
stdout | tests/WildcardMatching.test.ts > Wildcard Matching > should handle wildcards in the middle of a path
[astro-routify] → GET /api/a/foo/c
stdout | tests/HMR.test.ts > HMR Simulation > should maintain other routes during HMR
[RouterBuilder] Registered routes:
  GET     /keep
  GET     /change
[astro-routify] → GET /api/keep
stdout | tests/RouterBuilder.test.ts > RouterBuilder > should handle unmatched route as 404
[RouterBuilder] Registered routes:
[astro-routify] → GET /api/unknown
stdout | tests/Validation.test.ts > Validation Middleware > should validate query parameters
[astro-routify] ← responded 400 in 0ms
stdout | tests/RequestIndependence.test.ts > Request Independence > should maintain independent params for concurrent requests
[astro-routify] ← responded 200 in 5ms
stdout | tests/PriorityMatching.test.ts > Priority Matching > should follow priority: Static > Regex > Param > Wildcard > Catch-all
[astro-routify] ← responded 200 in 0ms
stdout | tests/WildcardMatching.test.ts > Wildcard Matching > should handle wildcards in the middle of a path
[astro-routify] ← responded 200 in 0ms
stdout | tests/HMR.test.ts > HMR Simulation > should maintain other routes during HMR
[astro-routify] ← responded 200 in 0ms
stdout | tests/RouterBuilder.test.ts > RouterBuilder > should handle unmatched route as 404
[astro-routify] ← responded 404 in 0ms
stdout | tests/RequestIndependence.test.ts > Request Independence > should maintain independent params for concurrent requests
[astro-routify] ← responded 200 in 5ms
stdout | tests/WildcardMatching.test.ts > Wildcard Matching > should handle wildcards in the middle of a path
[astro-routify] → GET /api/a/b/d
stdout | tests/HMR.test.ts > HMR Simulation > should maintain other routes during HMR
[astro-routify] → GET /api/change
stdout | tests/RequestIndependence.test.ts > Request Independence > should maintain independent params for concurrent requests
[astro-routify] ← responded 200 in 5ms
stdout | tests/WildcardMatching.test.ts > Wildcard Matching > should handle wildcards in the middle of a path
[astro-routify] ← responded 404 in 0ms
stdout | tests/HMR.test.ts > HMR Simulation > should maintain other routes during HMR
[astro-routify] ← responded 200 in 0ms
stdout | tests/RequestIndependence.test.ts > Request Independence > should maintain independent params for concurrent requests
[astro-routify] ← responded 200 in 4ms
stdout | tests/RouterBuilder.test.ts > RouterBuilder > should register routes from modules using addModules
[RouterBuilder] Registered routes:
  GET     /route1
[astro-routify] → GET /api/route1
stdout | tests/WildcardMatching.test.ts > Wildcard Matching > should allow mixing * and **
[RouterBuilder] Registered routes:
  GET     /api/*/static/**
[astro-routify] → GET /api/api/v1/static/css/style.css
stdout | tests/HMR.test.ts > HMR Simulation > should maintain other routes during HMR
[RouterBuilder] Registered routes:
  GET     /keep
  GET     /change
[astro-routify] → GET /api/keep
stdout | tests/RequestIndependence.test.ts > Request Independence > should maintain independent params for concurrent requests
[astro-routify] ← responded 200 in 6ms
stdout | tests/WildcardMatching.test.ts > Wildcard Matching > should allow mixing * and **
[astro-routify] ← responded 200 in 0ms
stdout | tests/HMR.test.ts > HMR Simulation > should maintain other routes during HMR
[astro-routify] ← responded 200 in 0ms
stdout | tests/RequestIndependence.test.ts > []0;node (vitest 10)2mRequest Independence > should maintain independent params for concurrent requests
[astro-routify] ← responded 200 in 6ms
stdout | tests/WildcardMatching.test.ts > Wildcard Matching > should allow mixing * and **
[astro-routify] → GET /api/api/v2/static
stdout | tests/HMR.test.ts > HMR Simulation > should maintain other routes during HMR
[astro-routify] → GET /api/change
stdout | tests/RouterBuilder.test.ts > RouterBuilder > should register routes from modules using addModules
[astro-routify] ← responded 200 in 0ms
stdout | tests/RequestIndependence.test.ts > Request Independence > should maintain independent params for concurrent requests
[astro-routify] ← responded 200 in 5ms
stdout | tests/WildcardMatching.test.ts > Wildcard Matching > should allow mixing * and **
[astro-routify] ← responded 200 in 0ms
stdout | tests/HMR.test.ts > HMR Simulation > should maintain other routes during HMR
[astro-routify] ← responded 200 in 0ms
 ✓ tests/Validation.test.ts (3 tests) 10ms
stdout | tests/defineRouter.test.ts > defineRouter - basePath handling > should match the route and strip basePath correctly
[astro-routify] → GET /custom-api/test
stdout | tests/RequestIndependence.test.ts > Request Independence > should maintain independent params for concurrent requests
[astro-routify] ← responded 200 in 5ms
 ✓ tests/PriorityMatching.test.ts (2 tests) 9ms
stdout | tests/WildcardMatching.test.ts > Wildcard Matching > should match catch-all with zero segments
[RouterBuilder] Registered routes:
  GET     /docs/**
[astro-routify] → GET /api/docs
stdout | tests/HMR.test.ts > HMR Simulation > should handle complex mixed registration HMR
[RouterBuilder] Registered routes:
  GET     /a
  GET     /b
[astro-routify] → GET /api/a
stdout | tests/RequestIndependence.test.ts > Request Independence > should maintain independent params for concurrent requests
[astro-routify] ← responded 200 in 5ms
stdout | tests/WildcardMatching.test.ts > Wildcard Matching > should match catch-all with zero segments
[astro-routify] ← responded 200 in 0ms
stdout | tests/HMR.test.ts > HMR Simulation > should handle complex mixed registration HMR
[astro-routify] ← responded 200 in 0ms
stdout | tests/RouterBuilder.test.ts > RouterBuilder > should register routes from modules using addModules
[astro-routify] → GET /api/group1/sub1
stdout | tests/RequestIndependence.test.ts > Request Independence > should maintain independent params for concurrent requests
[astro-routify] ← responded 200 in 5ms
stdout | tests/WildcardMatching.test.ts > Wildcard Matching > should match catch-all with zero segments
[astro-routify] → GET /api/docs/
stdout | tests/HMR.test.ts > HMR Simulation > should handle complex mixed registration HMR
[astro-routify] → GET /api/b
stdout | tests/RequestIndependence.test.ts > Request Independence > should maintain independent params for concurrent requests
[astro-routify] ← responded 200 in 6ms
stdout | tests/RouterBuilder.test.ts > RouterBuilder > should register routes from modules using addModules
[astro-routify] ← responded 200 in 0ms
stdout | tests/WildcardMatching.test.ts > Wildcard Matching > should match catch-all with zero segments
[astro-routify] ← responded 200 in 0ms
 ✓ tests/ErrorHandling.test.ts (2 tests) 9ms
stdout | tests/RequestIndependence.test.ts > Request Independence > should maintain independent params for concurrent requests
[astro-routify] ← responded 200 in 6ms
stdout | tests/HMR.test.ts > HMR Simulation > should handle complex mixed registration HMR
[astro-routify] ← responded 200 in 0ms
stdout | tests/defineGroup.integration.test.ts > RouterBuilder + defineGroup - route handling > should match a group route and return correct response
[astro-routify] ← responded 200 in 1ms
stdout | tests/RequestIndependence.test.ts > Request Independence > should maintain independent params for concurrent requests
[astro-routify] ← responded 200 in 6ms
stdout | tests/RequestIndependence.test.ts > Request Independence > should maintain independent params for concurrent requests
[astro-routify] ← responded 200 in 6ms
 ✓ tests/WildcardMatching.test.ts (5 tests) 10ms
stdout | tests/HMR.test.ts > HMR Simulation > should handle complex mixed registration HMR
[RouterBuilder] Registered routes:
  GET     /a
  GET     /b
[astro-routify] → GET /api/a
stdout | tests/RouterBuilder.test.ts > RouterBuilder > should use createRouter helper
[RouterBuilder] Registered routes:
  GET     /auto
[astro-routify] → GET /api/auto
stdout | tests/HMR.test.ts > HMR Simulation > should handle complex mixed registration HMR
[astro-routify] ← responded 200 in 0ms
stdout | tests/RouterBuilder.test.ts > RouterBuilder > should use createRouter helper
[astro-routify] ← responded 200 in 0ms
stdout | tests/HMR.test.ts > HMR Simulation > should handle complex mixed registration HMR
[astro-routify] → GET /api/b
stdout | tests/HMR.test.ts > HMR Simulation > should handle complex mixed registration HMR
[astro-routify] ← responded 200 in 0ms
stdout | tests/defineRouter.test.ts > defineRouter - basePath handling > should match the route and strip basePath correctly
[astro-routify] ← responded 200 in 2ms
stdout | tests/RequestIndependence.test.ts > Request Independence > should maintain independent params for concurrent requests
[astro-routify] ← responded 200 in 7ms
 ✓ tests/HMR.test.ts (4 tests) 11ms
stdout | tests/RouterBuilder.test.ts > RouterBuilder > should trace matches in debug mode
[astro-routify] → GET /api/debug
stdout | tests/RequestIndependence.test.ts > Request Independence > should maintain independent params for concurrent requests
[astro-routify] ← responded 200 in 7ms
stdout | tests/RouterBuilder.test.ts > RouterBuilder > should trace matches in debug mode
[astro-routify] ← responded 200 in 0ms
stdout | tests/RequestIndependence.test.ts > Request Independence > should maintain independent params for concurrent requests
[astro-routify] ← responded 200 in 7ms
stdout | tests/RequestIndependence.test.ts > Request Independence > should maintain independent params for concurrent requests
[astro-routify] ← responded 200 in 7ms
stdout | tests/RequestIndependence.test.ts > Request Independence > should maintain independent params for concurrent requests
[astro-routify] ← responded 200 in 7ms
stdout | tests/RequestIndependence.test.ts > Request Independence > should maintain independent params for concurrent requests
[astro-routify] ← responded 200 in 7ms
stdout | tests/RequestIndependence.test.ts > Request Independence > should maintain independent params for concurrent requests
[astro-routify] ← responded 200 in 8ms
stdout | tests/RequestIndependence.test.ts > Request Independence > should maintain independent params for concurrent requests
[astro-routify] ← responded 200 in 8ms
stdout | tests/RequestIndependence.test.ts > Request Independence > should maintain independent params for concurrent requests
[astro-routify] ← responded 200 in 7ms
stdout | tests/RequestIndependence.test.ts > Request Independence > should maintain independent params for concurrent requests
[astro-routify] ← responded 200 in 7ms
stdout | tests/RequestIndependence.test.ts > Request Independence > should maintain independent params for concurrent requests
[astro-routify] ← responded 200 in 7ms
stdout | tests/RequestIndependence.test.ts > Request Independence > should maintain independent params for concurrent requests
[astro-routify] ← responded 200 in 7ms
stdout | tests/RequestIndependence.test.ts > Request Independence > should maintain independent params for concurrent requests
[astro-routify] ← responded 200 in 7ms
stdout | tests/RequestIndependence.test.ts > Request Independence > should maintain independent params for concurrent requests
[astro-routify] ← responded 200 in 7ms
stdout | tests/RequestIndependence.test.ts > Request Independence > should maintain independent params for concurrent requests
[astro-routify] ← responded 200 in 7ms
stdout | tests/RequestIndependence.test.ts > Request Independence > should maintain independent params for concurrent requests
[astro-routify] ← responded 200 in 8ms
stdout | tests/RequestIndependence.test.ts > Request Independence > should maintain independent params for concurrent requests
[astro-routify] ← responded 200 in 8ms
stdout | tests/RequestIndependence.test.ts > Request Independence > should maintain independent params for concurrent requests
[astro-routify] ← responded 200 in 7ms
stdout | tests/RequestIndependence.test.ts > Request Independence > should maintain independent params for concurrent requests
[astro-routify] ← responded 200 in 8ms
stdout | tests/defineGroup.integration.test.ts > RouterBuilder + defineGroup - route handling > should return 404 for unmatched group route
[RouterBuilder] Registered routes:
[astro-routify] → GET /api/unknown
stdout | tests/defineGroup.integration.test.ts > RouterBuilder + defineGroup - route handling > should return 404 for unmatched group route
[astro-routify] ← responded 404 in 0ms
stdout | tests/RequestIndependence.test.ts > Request Independence > should maintain independent params for concurrent requests
[astro-routify] ← responded 200 in 9ms
stdout | tests/RequestIndependence.test.ts > Request Independence > should maintain independent params for concurrent requests
[astro-routify] ← responded 200 in 8ms
stdout | tests/RequestIndependence.test.ts > Request Independence > should maintain independent params for concurrent requests
[astro-routify] ← responded 200 in 8ms
stdout | tests/defineRouter.test.ts > defineRouter - basePath handling > should match a nested route
[astro-routify] → GET /custom-api/v1/items/list
stdout | tests/RequestIndependence.test.ts > Request Independence > should maintain independent params for concurrent requests
[astro-routify] ← responded 200 in 8ms
stdout | tests/RequestIndependence.test.ts > Request Independence > should maintain independent params for concurrent requests
[astro-routify] ← responded 200 in 8ms
stdout | tests/defineRouter.test.ts > defineRouter - basePath handling > should match a nested route
[astro-routify] ← responded 200 in 0ms
stdout | tests/defineGroup.integration.test.ts > RouterBuilder + defineGroup - route handling > should return 405 for method not allowed in group
[RouterBuilder] Registered routes:
[astro-routify] → POST /api/auth/login
stdout | tests/RequestIndependence.test.ts > Request Independence > should maintain independent params for concurrent requests
[astro-routify] ← responded 200 in 8ms
stdout | tests/defineGroup.integration.test.ts > RouterBuilder + defineGroup - route handling > should return 405 for method not allowed in group
[astro-routify] ← responded 405 in 0ms
stdout | tests/RequestIndependence.test.ts > Request Independence > should maintain independent params for concurrent requests
[astro-routify] ← responded 200 in 8ms
stdout | tests/defineRouter.test.ts > defineRouter - basePath handling > should handle dynamic parameters
[astro-routify] → GET /custom-api/users/42
stdout | tests/defineGroup.integration.test.ts > RouterBuilder + defineGroup - route handling > should match a route with trailing slash in group
[RouterBuilder] Registered routes:
[astro-routify] → GET /api/state/sync/
stdout | tests/RequestIndependence.test.ts > Request Independence > should maintain independent params for concurrent requests
[astro-routify] ← responded 200 in 8ms
stdout | tests/defineRouter.test.ts > defineRouter - basePath handling > should handle dynamic parameters
[astro-routify] ← responded 200 in 0ms
stdout | tests/RequestIndependence.test.ts > Request Independence > should maintain independent params for concurrent requests
[astro-routify] ← responded 200 in 8ms
stdout | tests/RequestIndependence.test.ts > Request Independence > should maintain independent params for concurrent requests
[astro-routify] ← responded 200 in 8ms
stdout | tests/RequestIndependence.test.ts > Request Independence > should maintain independent params for concurrent requests
[astro-routify] ← responded 200 in 8ms
stdout | tests/defineGroup.integration.test.ts > RouterBuilder + defineGroup - route handling > should match a route with trailing slash in group
[astro-routify] ← responded 200 in 0ms
 ✓ tests/RouterBuilder.test.ts (10 tests) 13ms
stdout | tests/defineRouter.test.ts > defineRouter - basePath handling > should match a route with trailing slash
[astro-routify] → GET /custom-api/trailing/
stdout | tests/defineRouter.test.ts > defineRouter - basePath handling > should match a route with trailing slash
[astro-routify] ← responded 200 in 0ms
stdout | tests/defineGroup.integration.test.ts > RouterBuilder + defineGroup - route handling > should match multiple groups and route to correct handler
[RouterBuilder] Registered routes:
[astro-routify] → GET /api/users/42
stdout | tests/RequestIndependence.test.ts > Request Independence > should maintain independent params for concurrent requests
[astro-routify] ← responded 200 in 9ms
stdout | tests/defineGroup.integration.test.ts > RouterBuilder + defineGroup - route handling > should match multiple groups and route to correct handler
[astro-routify] ← responded 200 in 0ms
stdout | tests/defineGroup.integration.test.ts > RouterBuilder + defineGroup - route handling > should match multiple groups and route to correct handler
[astro-routify] → GET /api/posts/hello
stdout | tests/defineRouter.test.ts > defineRouter - basePath handling > should return notFound for unmatched route
[astro-routify] → GET /custom-api/does-not-exist
stdout | tests/defineGroup.integration.test.ts > RouterBuilder + defineGroup - route handling > should match multiple groups and route to correct handler
[astro-routify] ← responded 200 in 0ms
stdout | tests/defineRouter.test.ts > defineRouter - basePath handling > should return notFound for unmatched route
[astro-routify] ← responded 404 in 0ms
stdout | tests/defineRouter.test.ts > defineRouter - basePath handling > should work with default basePath (/api)
[astro-routify] → GET /api/hello
stdout | tests/defineGroup.integration.test.ts > RouterBuilder + defineGroup - route handling > should work with custom notFound handler in builder
[RouterBuilder] Registered routes:
[astro-routify] → GET /api/unknown/path
stdout | tests/defineGroup.integration.test.ts > RouterBuilder + defineGroup - route handling > should work with custom notFound handler in builder
[astro-routify] ← responded 404 in 0ms
stdout | tests/defineRouter.test.ts > defineRouter - basePath handling > should work with default basePath (/api)
[astro-routify] ← responded 200 in 0ms
stdout | tests/defineGroup.integration.test.ts > RouterBuilder + defineGroup - route handling > should extract param from group base path
[RouterBuilder] Registered routes:
[astro-routify] → GET /api/section/settings/info
stdout | tests/defineGroup.integration.test.ts > RouterBuilder + defineGroup - route handling > should extract param from group base path
[astro-routify] ← responded 200 in 0ms
stdout | tests/defineRouter.test.ts > defineRouter - basePath handling > should return a file with correct headers and content
[astro-routify] → GET /api/download
stdout | tests/defineRouter.test.ts > defineRouter - basePath handling > should return a file with correct headers and content
[astro-routify] ← responded 200 in 0ms
stdout | tests/RequestIndependence.test.ts > Request Independence > should not leak ctx.params between different routes
[RouterBuilder] Registered routes:
  GET     /a/:id
  GET     /b/:name
[astro-routify] → GET /api/a/123
stdout | tests/RequestIndependence.test.ts > Request Independence > should not leak ctx.params between different routes
[astro-routify] ← responded 200 in 0ms
stdout | tests/defineGroup.integration.test.ts > RouterBuilder + defineGroup - route handling > should extract params from both group and route
[RouterBuilder] Registered routes:
[astro-routify] → GET /api/group/alpha/item/123
stdout | tests/defineGroup.integration.test.ts > RouterBuilder + defineGroup - route handling > should extract params from both group and route
[astro-routify] ← responded 200 in 0ms
stdout | tests/RequestIndependence.test.ts > Request Independence > should not leak ctx.params between different routes
[astro-routify] → GET /api/b/joe
stdout | tests/RequestIndependence.test.ts > Request Independence > should not leak ctx.params between different routes
[astro-routify] ← responded 200 in 0ms
stdout | tests/defineGroup.integration.test.ts > RouterBuilder + defineGroup - route handling > should support configuration callback
[RouterBuilder] Registered routes:
[astro-routify] → GET /api/configured/hello
stdout | tests/RequestIndependence.test.ts > Request Independence > should preserve original ctx.params if they existed
[RouterBuilder] Registered routes:
  GET     /users/:id
[astro-routify] → GET /api/users/123
stdout | tests/defineRouter.test.ts > defineRouter - basePath handling > should match both /path and /path/ for the same route
[astro-routify] → GET /api/docs
stdout | tests/RequestIndependence.test.ts > Request Independence > should preserve original ctx.params if they existed
[astro-routify] ← responded 200 in 0ms
stdout | tests/defineRouter.test.ts > defineRouter - basePath handling > should match both /path and /path/ for the same route
[astro-routify] ← responded 200 in 0ms
stdout | tests/defineGroup.integration.test.ts > RouterBuilder + defineGroup - route handling > should support configuration callback
[astro-routify] ← responded 200 in 0ms
stdout | tests/defineRouter.test.ts > defineRouter - basePath handling > should match both /path and /path/ for the same route
[astro-routify] → GET /api/docs/
stdout | tests/defineRouter.test.ts > defineRouter - basePath handling > should match both /path and /path/ for the same route
[astro-routify] ← responded 200 in 0ms
 ✓ tests/defineRouter.test.ts (8 tests) 10ms
stdout | tests/RequestIndependence.test.ts > Request Independence > should not mix response headers between concurrent requests
[RouterBuilder] Registered routes:
  GET     /headers/:val
[astro-routify] → GET /api/headers/val-0
[astro-routify] → GET /api/headers/val-1
[astro-routify] → GET /api/headers/val-2
[astro-routify] → GET /api/headers/val-3
[astro-routify] → GET /api/headers/val-4
[astro-routify] → GET /api/headers/val-5
[astro-routify] → GET /api/headers/val-6
[astro-routify] → GET /api/headers/val-7
[astro-routify] → GET /api/headers/val-8
[astro-routify] → GET /api/headers/val-9
[astro-routify] → GET /api/headers/val-10
[astro-routify] → GET /api/headers/val-11
[astro-routify] → GET /api/headers/val-12
[astro-routify] → GET /api/headers/val-13
[astro-routify] → GET /api/headers/val-14
[astro-routify] → GET /api/headers/val-15
[astro-routify] → GET /api/headers/val-16
[astro-routify] → GET /api/headers/val-17
[astro-routify] → GET /api/headers/val-18
[astro-routify] → GET /api/headers/val-19
stdout | tests/RequestIndependence.test.ts > Request Independence > should not mix response headers between concurrent requests
[astro-routify] ← responded 200 in 1ms
[astro-routify] ← responded 200 in 1ms
[astro-routify] ← responded 200 in 1ms
[astro-routify] ← responded 200 in 1ms
[astro-routify] ← responded 200 in 1ms
[astro-routify] ← responded 200 in 1ms
[astro-routify] ← responded 200 in 1ms
[astro-routify] ← responded 200 in 1ms
[astro-routify] ← responded 200 in 1ms
[astro-routify] ← responded 200 in 1ms
[astro-routify] ← responded 200 in 1ms
[astro-routify] ← responded 200 in 1ms
[astro-routify] ← responded 200 in 1ms
[astro-routify] ← responded 200 in 1ms
[astro-routify] ← responded 200 in 1ms
[astro-routify] ← responded 200 in 1ms
[astro-routify] ← responded 200 in 1ms
[astro-routify] ← responded 200 in 1ms
[astro-routify] ← responded 200 in 1ms
[astro-routify] ← responded 200 in 1ms
 ✓ tests/defineGroup.integration.test.ts (9 tests) 11ms
stdout | tests/RequestIndependence.test.ts > Request Independence > should handle sequential requests to different methods on same path independently
[RouterBuilder] Registered routes:
  GET     /item
  POST    /item
[astro-routify] → GET /api/item
stdout | tests/RequestIndependence.test.ts > Request Independence > should handle sequential requests to different methods on same path independently
[astro-routify] ← responded 200 in 0ms
stdout | tests/RequestIndependence.test.ts > Request Independence > should handle sequential requests to different methods on same path independently
[astro-routify] → POST /api/item
stdout | tests/RequestIndependence.test.ts > Request Independence > should handle sequential requests to different methods on same path independently
[astro-routify] ← responded 200 in 0ms
stdout | tests/RequestIndependence.test.ts > Request Independence > should handle sequential requests to different methods on same path independently
[astro-routify] → DELETE /api/item
stdout | tests/RequestIndependence.test.ts > Request Independence > should handle sequential requests to different methods on same path independently
[astro-routify] ← responded 405 in 0ms
 ✓ tests/RequestIndependence.test.ts (5 tests) 20ms
stdout | tests/streamJson.integration.test.ts > streamJson split helpers - integration > handles invalid JSON (circular) gracefully
[astro-routify] → GET /api/error
stdout | tests/streamJson.integration.test.ts > streamJson split helpers - integration > handles invalid JSON (circular) gracefully
[astro-routify] ← responded 200 in 1ms
stdout | tests/streamJson.integration.test.ts > streamJson split helpers - integration > uses route param (e.g. /user/:id)
[astro-routify] → GET /api/user/42
stdout | tests/streamJson.integration.test.ts > streamJson split helpers - integration > uses route param (e.g. /user/:id)
[astro-routify] ← responded 200 in 0ms
stdout | tests/streamJson.integration.test.ts > streamJson split helpers - integration > supports nested routes (e.g. /nested/deep/stream)
[astro-routify] → GET /api/nested/deep/stream
stdout | tests/streamJson.integration.test.ts > streamJson split helpers - integration > supports nested routes (e.g. /nested/deep/stream)
[astro-routify] ← responded 200 in 0ms
 ✓ tests/streamJson.integration.test.ts (6 tests) 113ms
 Test Files  21 passed (21)
      Tests  98 passed (98)
   Start at  11:15:14
   Duration  889ms (transform 1.29s, setup 0ms, collect 5.49s, tests 279ms, environment 2ms, prepare 3.82s)